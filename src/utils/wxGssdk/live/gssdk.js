/*!
 * Gensee EasyCast JavaScript SDK
 * http://www.gensee.com/
 * Date: 2019-10-16
 */
"use strict";function loadHisTask(e){var t={};t.taskId=e,t.time=(new Date).getTime(),hTasks.push(t)}function compareHisTask(e){for(var t=0;t<hTasks.length;t++){if(e==hTasks[t].taskId)return!0}return!1}function XMLReader(){}function _parse(e,t,n,i,r){function o(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(r.error("entity not found:"+e),e)}function a(t){if(t>h){var n=e.substring(h,t).replace(/&#?\w+;/g,o);d&&s(h),i.characters(n,0,t-h),h=t}}function s(t,n){for(;t>=u&&(n=c.exec(e));)l=n.index,u=l+n[0].length,d.lineNumber++;d.columnNumber=t-l+1}for(var l=0,u=0,c=/.*(?:\r\n?|\n)|.*$/g,d=i.locator,p=[{currentNSMap:t}],f={},h=0;;){try{var m=e.indexOf("<",h);if(m<0){if(!e.substr(h).match(/^\s*$/)){var g=i.doc,N=g.createTextNode(e.substr(h));g.appendChild(N),i.currentElement=N}return}switch(m>h&&a(m),e.charAt(m+1)){case"/":var E=e.indexOf(">",m+3),T=e.substring(m+2,E),v=p.pop();E<0?(T=e.substring(m+2).replace(/[\s<].*/,""),r.error("end tag name: "+T+" is not complete:"+v.tagName),E=m+1+T.length):T.match(/\s</)&&(T=T.replace(/[\s<].*/,""),r.error("end tag name: "+T+" maybe not complete"),E=m+1+T.length);var y=v.localNSMap,_=v.tagName==T;if(_||v.tagName&&v.tagName.toLowerCase()==T.toLowerCase()){if(i.endElement(v.uri,v.localName,T),y)for(var D in y)i.endPrefixMapping(D);_||r.fatalError("end tag name: "+T+" is not match the current start tagName:"+v.tagName)}else p.push(v);E++;break;case"?":d&&s(m),E=parseInstruction(e,m,i);break;case"!":d&&s(m),E=parseDCC(e,m,i,r);break;default:d&&s(m);var S=new ElementAttributes,A=p[p.length-1].currentNSMap,O=(E=parseElementStartPart(e,m,S,A,o,r),S.length);if(!S.closed&&fixSelfClosed(e,E,S.tagName,f)&&(S.closed=!0,n.nbsp||r.warning("unclosed xml attribute")),d&&O){for(var w=copyLocator(d,{}),R=0;R<O;R++){var C=S[R];s(C.offset),C.locator=copyLocator(d,{})}i.locator=w,appendElementFromSax(S,i,A)&&p.push(S),i.locator=d}else appendElementFromSax(S,i,A)&&p.push(S);"http://www.w3.org/1999/xhtml"!==S.uri||S.closed?E++:E=parseHtmlSpecialContent(e,E,S.tagName,o,i)}}catch(e){r.error("element parse error: "+e),E=-1}E>h?h=E:a(Math.max(m,h)+1)}}function copyLocator(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function parseElementStartPart(e,t,n,i,r,o){for(var a,s=++t,l=S_TAG;;){var u=e.charAt(s);switch(u){case"=":if(l===S_ATTR)a=e.slice(t,s),l=S_EQ;else{if(l!==S_ATTR_SPACE)throw new Error("attribute equal must after attrName");l=S_EQ}break;case"'":case'"':if(l===S_EQ||l===S_ATTR){if(l===S_ATTR&&(o.warning('attribute value must after "="'),a=e.slice(t,s)),t=s+1,!((s=e.indexOf(u,t))>0))throw new Error("attribute value no end '"+u+"' match");c=e.slice(t,s).replace(/&#?\w+;/g,r),n.add(a,c,t-1),l=S_ATTR_END}else{if(l!=S_ATTR_NOQUOT_VALUE)throw new Error('attribute value must after "="');c=e.slice(t,s).replace(/&#?\w+;/g,r),n.add(a,c,t),o.warning('attribute "'+a+'" missed start quot('+u+")!!"),t=s+1,l=S_ATTR_END}break;case"/":switch(l){case S_TAG:n.setTagName(e.slice(t,s));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:l=S_TAG_CLOSE,n.closed=!0;case S_ATTR_NOQUOT_VALUE:case S_ATTR:case S_ATTR_SPACE:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),l==S_TAG&&n.setTagName(e.slice(t,s)),s;case">":switch(l){case S_TAG:n.setTagName(e.slice(t,s));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:break;case S_ATTR_NOQUOT_VALUE:case S_ATTR:"/"===(c=e.slice(t,s)).slice(-1)&&(n.closed=!0,c=c.slice(0,-1));case S_ATTR_SPACE:l===S_ATTR_SPACE&&(c=a),l==S_ATTR_NOQUOT_VALUE?(o.warning('attribute "'+c+'" missed quot(")!!'),n.add(a,c.replace(/&#?\w+;/g,r),t)):("http://www.w3.org/1999/xhtml"===i[""]&&c.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),n.add(c,c,t));break;case S_EQ:throw new Error("attribute value missed!!")}return s;case"Â€":u=" ";default:if(u<=" ")switch(l){case S_TAG:n.setTagName(e.slice(t,s)),l=S_TAG_SPACE;break;case S_ATTR:a=e.slice(t,s),l=S_ATTR_SPACE;break;case S_ATTR_NOQUOT_VALUE:var c=e.slice(t,s).replace(/&#?\w+;/g,r);o.warning('attribute "'+c+'" missed quot(")!!'),n.add(a,c,t);case S_ATTR_END:l=S_TAG_SPACE}else switch(l){case S_ATTR_SPACE:n.tagName,"http://www.w3.org/1999/xhtml"===i[""]&&a.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),n.add(a,a,t),t=s,l=S_ATTR;break;case S_ATTR_END:o.warning('attribute space is required"'+a+'"!!');case S_TAG_SPACE:l=S_ATTR,t=s;break;case S_EQ:l=S_ATTR_NOQUOT_VALUE,t=s;break;case S_TAG_CLOSE:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function appendElementFromSax(e,t,n){for(var i=e.tagName,r=null,o=e.length;o--;){var a=e[o],s=a.qName,l=a.value;if((p=s.indexOf(":"))>0)var u=a.prefix=s.slice(0,p),c=s.slice(p+1),d="xmlns"===u&&c;else c=s,u=null,d="xmlns"===s&&"";a.localName=c,!1!==d&&(null==r&&(r={},_copy(n,n={})),n[d]=r[d]=l,a.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,l))}for(o=e.length;o--;)(u=(a=e[o]).prefix)&&("xml"===u&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(a.uri=n[u||""]));var p;(p=i.indexOf(":"))>0?(u=e.prefix=i.slice(0,p),c=e.localName=i.slice(p+1)):(u=null,c=e.localName=i);var f=e.uri=n[u||""];if(t.startElement(f,c,i,e),!e.closed)return e.currentNSMap=n,e.localNSMap=r,!0;if(t.endElement(f,c,i),r)for(u in r)t.endPrefixMapping(u)}function parseHtmlSpecialContent(e,t,n,i,r){if(/^(?:script|textarea)$/i.test(n)){var o=e.indexOf("</"+n+">",t),a=e.substring(t+1,o);if(/[&<]/.test(a))return/^script$/i.test(n)?(r.characters(a,0,a.length),o):(a=a.replace(/&#?\w+;/g,i),r.characters(a,0,a.length),o)}return t+1}function fixSelfClosed(e,t,n,i){var r=i[n];return null==r&&((r=e.lastIndexOf("</"+n+">"))<t&&(r=e.lastIndexOf("</"+n)),i[n]=r),r<t}function _copy(e,t){for(var n in e)t[n]=e[n]}function parseDCC(e,t,n,i){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,r-t-4),r+3):(i.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,r-t-9),n.endCDATA(),r+3}var o=split(e,t),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var s=o[1][0],l=a>3&&/^public$/i.test(o[2][0])&&o[3][0],u=a>4&&o[4][0],c=o[a-1];return n.startDTD(s,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),c.index+c[0].length}}return-1}function parseInstruction(e,t,n){var i=e.indexOf("?>",t);if(i){var r=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,n.processingInstruction(r[1],r[2]),i+2):-1}return-1}function ElementAttributes(e){}function split(e,t){var n,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=t,r.exec(e);n=r.exec(e);)if(i.push(n),n[1])return i}function copy(e,t){for(var n in e)t[n]=e[n]}function _extends(e,t){var n=e.prototype;if(!(n instanceof t)){var i=function(){};i.prototype=t.prototype,copy(n,i=new i),e.prototype=n=i}n.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),n.constructor=e)}function DOMException(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,ExceptionMessage[e]),this.message=ExceptionMessage[e],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return n.code=e,t&&(this.message=this.message+": "+t),n}function NodeList(){}function LiveNodeList(e,t){this._node=e,this._refresh=t,_updateLiveList(this)}function _updateLiveList(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);__set__(e,"length",n.length),copy(n,e),e._inc=t}}function NamedNodeMap(){}function _findNodeIndex(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function _addNamedNode(e,t,n,i){if(i?t[_findNodeIndex(t,i)]=n:t[t.length++]=n,e){n.ownerElement=e;var r=e.ownerDocument;r&&(i&&_onRemoveAttribute(r,e,i),_onAddAttribute(r,e,n))}}function _removeNamedNode(e,t,n){var i=_findNodeIndex(t,n);if(!(i>=0))throw DOMException(NOT_FOUND_ERR,new Error(e.tagName+"@"+n));for(var r=t.length-1;i<r;)t[i]=t[++i];if(t.length=r,e){var o=e.ownerDocument;o&&(_onRemoveAttribute(o,e,n),n.ownerElement=null)}}function DOMImplementation(e){if(this._features={},e)for(var t in e)this._features=e[t]}function Node(){}function _xmlEncoder(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function _visitNode(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(_visitNode(e,t))return!0}while(e=e.nextSibling)}function Document(){}function _onAddAttribute(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}function _onRemoveAttribute(e,t,n,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function _onUpdateChild(e,t,n){if(e&&e._inc){e._inc++;var i=t.childNodes;if(n)i[i.length++]=n;else{for(var r=t.firstChild,o=0;r;)i[o++]=r,r=r.nextSibling;i.length=o}}}function _removeChild(e,t){var n=t.previousSibling,i=t.nextSibling;return n?n.nextSibling=i:e.firstChild=i,i?i.previousSibling=n:e.lastChild=n,_onUpdateChild(e.ownerDocument,e),t}function _insertBefore(e,t,n){var i=t.parentNode;if(i&&i.removeChild(t),t.nodeType===DOCUMENT_FRAGMENT_NODE){var r=t.firstChild;if(null==r)return t;var o=t.lastChild}else r=o=t;var a=n?n.previousSibling:e.lastChild;for(r.previousSibling=a,o.nextSibling=n,a?a.nextSibling=r:e.firstChild=r,null==n?e.lastChild=o:n.previousSibling=o;r.parentNode=e,r!==o&&(r=r.nextSibling););return _onUpdateChild(e.ownerDocument||e,e),t.nodeType==DOCUMENT_FRAGMENT_NODE&&(t.firstChild=t.lastChild=null),t}function _appendSingleChild(e,t){var n=t.parentNode;if(n){var i=e.lastChild;n.removeChild(t),i=e.lastChild}return i=e.lastChild,t.parentNode=e,t.previousSibling=i,t.nextSibling=null,i?i.nextSibling=t:e.firstChild=t,e.lastChild=t,_onUpdateChild(e.ownerDocument,e,t),t}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(e,t){var n=[],i=9==this.nodeType&&this.documentElement||this,r=i.prefix,o=i.namespaceURI;if(o&&null==r&&null==(r=i.lookupPrefix(o)))var a=[{namespace:o,prefix:null}];return serializeToString(this,n,e,t,a),n.join("")}function needNamespaceDefine(e,t,n){var i=e.prefix||"",r=e.namespaceURI;if(!i&&!r)return!1;if("xml"===i&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r)return!1;for(var o=n.length;o--;){var a=n[o];if(a.prefix==i)return a.namespace!=r}return!0}function serializeToString(e,t,n,i,r){if(i){if(!(e=i(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case ELEMENT_NODE:r||(r=[]),r.length;var o=e.attributes,a=o.length,s=e.firstChild,l=e.tagName;n=htmlns===e.namespaceURI||n,t.push("<",l);for(var u=0;u<a;u++)"xmlns"==(c=o.item(u)).prefix?r.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&r.push({prefix:"",namespace:c.value});for(u=0;u<a;u++){var c;if(needNamespaceDefine(c=o.item(u),n,r)){var d=c.prefix||"",p=c.namespaceURI,f=d?" xmlns:"+d:" xmlns";t.push(f,'="',p,'"'),r.push({prefix:d,namespace:p})}serializeToString(c,t,n,i,r)}if(needNamespaceDefine(e,n,r)&&(d=e.prefix||"",p=e.namespaceURI,f=d?" xmlns:"+d:" xmlns",t.push(f,'="',p,'"'),r.push({prefix:d,namespace:p})),s||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(">"),n&&/^script$/i.test(l))for(;s;)s.data?t.push(s.data):serializeToString(s,t,n,i,r),s=s.nextSibling;else for(;s;)serializeToString(s,t,n,i,r),s=s.nextSibling;t.push("</",l,">")}else t.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(s=e.firstChild;s;)serializeToString(s,t,n,i,r),s=s.nextSibling;return;case ATTRIBUTE_NODE:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return t.push(e.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return t.push("<![CDATA[",e.data,"]]>");case COMMENT_NODE:return t.push("\x3c!--",e.data,"--\x3e");case DOCUMENT_TYPE_NODE:var h=e.publicId,m=e.systemId;if(t.push("<!DOCTYPE ",e.name),h)t.push(' PUBLIC "',h),m&&"."!=m&&t.push('" "',m),t.push('">');else if(m&&"."!=m)t.push(' SYSTEM "',m,'">');else{var g=e.internalSubset;g&&t.push(" [",g,"]"),t.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return t.push("<?",e.target," ",e.data,"?>");case ENTITY_REFERENCE_NODE:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function _importNode(e,t,n){var i;switch(t.nodeType){case ELEMENT_NODE:(i=t.cloneNode(!1)).ownerDocument=e;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:n=!0}if(i||(i=t.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,n)for(var r=t.firstChild;r;)i.appendChild(_importNode(e,r,n)),r=r.nextSibling;return i}function _cloneNode(e,t,n){var i=new t.constructor;for(var r in t){var o=t[r];"object"!=(void 0===o?"undefined":_typeof(o))&&o!=i[r]&&(i[r]=o)}switch(t.childNodes&&(i.childNodes=new NodeList),i.ownerDocument=e,i.nodeType){case ELEMENT_NODE:var a=t.attributes,s=i.attributes=new NamedNodeMap,l=a.length;s._ownerElement=i;for(var u=0;u<l;u++)i.setAttributeNode(_cloneNode(e,a.item(u),!0));break;case ATTRIBUTE_NODE:n=!0}if(n)for(var c=t.firstChild;c;)i.appendChild(_cloneNode(e,c,n)),c=c.nextSibling;return i}function __set__(e,t,n){e[t]=n}function DOMParser(e){this.options=e||{locator:{}}}function buildErrorHandler(e,t,n){function i(t){var i=e[t];!i&&o&&(i=2==e.length?function(n){e(t,n)}:e),r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+_locator(n))}||function(){}}if(!e){if(t instanceof DOMHandler)return t;e=t}var r={},o=e instanceof Function;return n=n||{},i("warning"),i("error"),i("fatalError"),r}function DOMHandler(){this.cdata=!1}function position(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function _locator(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function _toString(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function appendElement(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},app=getApp(),SDK=function(){var e={};e.defaultKey="_GS_SDK_default_group_"+(new Date).getTime(),e.suites={},e.widgets={},e.N=0,e.register=function(t,n){for(var i=t.split("."),r=e,o=null;o=i.shift();)i.length?(void 0===r[o]&&(r[o]={}),r=r[o]):void 0===r[o]&&(r[o]=n(e))},e.trim=function(e){return"string"!=typeof e?e:"function"==typeof e.trim?e.trim():e.replace(/^(\u3000|\s|\t|\u00A0)*|(\u3000|\s|\t|\u00A0)*$/g,"")},e.isEmpty=function(t){return void 0===t||(null==t||"string"==typeof t&&""==e.trim(t))},e.isNotEmpty=function(t){return!e.isEmpty(t)},e.Event=function(e,t,n,i,r){this.type=e,this.target=t,this.data=n,"string"==typeof i?this.receiver=i:(this.cb=i,this.receiver=r)},e.Logger=function(e){var t=this;this.name=e,this.logs=[];var n={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4};this.level="INFO",this.out=function(e){t.logs.push(e)},this.log=function(e,i,r){i=i||"info";var o=n[i.toUpperCase()],a=n[t.level.toUpperCase()];if(!("number"==typeof o&&"number"==typeof a&&o<a))return"string"!=typeof e?void this.log("log(msg, type), type of msg must be 'string'","ERROR",e):void 0},this.moveLogs=function(e){return t.logs.splice(0,e||t.logs.length)}},e.logger=new e.Logger,e.log=e.logger.log,e.asyncRun=function(t,n){setTimeout(function(){try{t(n)}catch(t){throw e.log(""+t,"ERROR",t),t}},0)},e.register("core.util.assignProperties",function(){return function(e,t,n,i){if(void 0!==t)for(var r in t){var o=t[r];"function"==typeof n&&(r=n(r)),"function"==typeof i&&(o=i(o)),e[r]=o}return e}});var t=function(){var t=function(e,t,n){this.enabled=!0,this.orign=e,this.type=t,this.elem=n?n.elem:{},this.attrs=n?n.attrs:null,this.initId()};return t.fn=t.prototype={constructor:t,attr:function(t){if(e.isNotEmpty(this.attrs))return this.attrs[t];var n="";try{this.elem.getAttribute&&(n=this.elem.getAttribute(t),n=e.trim(n))}catch(t){e.log(".getAttribute(name) throw:"+t,"ERROR",this)}return e.isEmpty(n)?"":n},initId:function(){var t=this.attr("id");e.isEmpty(t)&&(t="_GS_WIDGET_"+e.N++,t+="_"+(new Date).getTime()),this.id=t},bind:function(e,t){this.enabled&&(e=e.toLowerCase(),this.suite.eventsmap[e]||(this.suite.eventsmap[e]=[]),this.suite.eventsmap[e].push({wgid:this.id,handler:t}))},unbind:function(e,t){if(this.enabled){e=e.toLowerCase();var n=this.suite.eventsmap[e];if(n)for(var i=0;i<n.length;i++)if(n[i].handler==t){n.splice(i,1);break}}},fire:function(t){if(this.enabled){if(!(t instanceof e.Event))throw e.log("It's not instanceof Event - "+t,"ERROR"),"[SDK]ERROR! It's not a instance of Event - "+t;if("onRewardResponse"==t.type&&t.data&&void 0!=t.data.userControl&&"false"==t.data.userControl&&"0"==t.data.returnCode)return void(window.top.location.href=t.data.codeUrl);var n=t.type.toLowerCase(),i=this.suite.eventsmap[n],r=0;if(i){r=i.length;for(var o=t.receiver,a=0;a<i.length;a++)o?o==i[a].wgid&&e.asyncRun(i[a].handler,t):e.asyncRun(i[a].handler,t)}return e.log("send message of '"+t.type+"'","DEBUG",t),r}}},t}(),n=function(){var n=function(t){e.isEmpty(t)&&(t=e.defaultKey),this.key=t,this.init()};return n.fn=n.prototype={constructor:n,init:function(){this.eventsmap={},this.widgets={}},loadWidget:function(t){if(void 0===_typeof(t.id))throw new ERROR("widget's id is undefined. "+t);void 0===this.widgets[t.id]&&(t.suite=this,this.widgets[t.id]=t,e.widgets[t.id]=t,e.log("Widget("+t.id+") has loaded!","INFO",t))},createWidget:function(e,n,i){n=n.toLowerCase();var r=new t(e,n,i);return this.loadWidget(r),r},clearWidget:function(t){this.eventsmap={},this.widgets={},e.suites={},e.widgets={}},removeWidget:function(t){if(void 0===(void 0===t?"undefined":_typeof(t)))throw new ERROR("widgetId is undefined.");var n=this.widgets[t];if(e.isEmpty(n))throw new ERROR("widget not found in suite for widgetId:"+t);n.suite=null;for(var i in this.eventsmap){var r=this.eventsmap[i];if(r)for(var o=0;o<r.length;o++)if(r[o].wgid==t){r.splice(o,1);break}}return delete this.widgets[t],delete e.widgets[t],e.log("Widget("+t+") has remove!","INFO",t),n}},n}();return e.suite=function(t){e.isEmpty(t)&&(t=e.defaultKey);var i=e.suites[t];return void 0===i&&(i=new n(t),e.suites[t]=i),i},e}();SDK.logger.name="SDK",SDK.register("api.ready",function(){return function(e){SDK.core.dom.ready(e)}}),SDK.register("api.widget",function(){return function(e){return SDK.widgets[e]}}),SDK.register("api.widget.proxy",function(e){return function(t){var n=e.api.widget(t);if(e.isEmpty(n))throw e.log("No widget which id is "+t,"ERROR"),"[SDK]ERROR! no widget which id is "+t;if(void 0===n.proxy){var i=n.proxy={id:t,type:n.type,group:n.suite.key,enabled:!0};n.eventTargetProxy={id:t,type:n.type},i.extend=function(t){e.core.util.assignProperties(i,t)},i.bind=function(t,r){if(i.enabled){if("string"!=typeof t)return void e.log("Type of event must be a string!","ERROR");if("function"!=typeof r)return void e.log("Handler of event must be a function!","ERROR");if(t=e.trim(t),e.isEmpty(t))return void e.log("Empty type of event is invalid!","ERROR");n.bind(t,r)}},i.unbind=function(t,r){if(i.enabled){if("string"!=typeof t)return void e.log("Type of event must be a string!","ERROR");if("function"!=typeof r)return void e.log("Handler of event must be a function!","ERROR");if(t=e.trim(t),e.isEmpty(t))return void e.log("Empty type of event is invalid!","ERROR");n.unbind(t,r)}},i.send=function(t,r,o,a){if(i.enabled){if("string"==typeof o&&(a=o,o=void 0),"string"!=typeof t)throw e.log("Type of message must be a string!","ERROR"),"[SDK]ERROR! Type of message must be a string!";t=e.trim(t),t=typeCenter.types(t);var s=new e.Event(t,n.eventTargetProxy,r,o,a),l=n.fire(s);if(0==l){var u=n.suite.key==e.defaultKey?"":n.suite.key+".";e.log("No handler had bound to '"+u+s.type+"'!","WARN",s)}return l}},i.activeShakehand=function(t,r,o){if(i.enabled){n._dataInMyHand=r,"string"==typeof o&&e.isNotEmpty(o)?n._shakeWithType=o:delete n._shakeWithType,i.shakehand="function"==typeof t?function(e){setTimeout(function(){t(e._dataInMyHand)},0)}:function(){};var a=n.suite;if(a)for(var s in a.widgets){var l=a.widgets[s];if(l.id!=n.id){var u=e.api.widget.proxy(l.id);if(e.isNotEmpty(u.shakehand)){var c=!0;n._shakeWithType&&n._shakeWithType!=l.type&&(c=!1);var d=!0;l._shakeWithType&&l._shakeWithType!=n.type&&(d=!1),c&&d&&(i.shakehand(l),u.shakehand(n))}}}}}}return n.proxy}});var typeCenter=function(){var e={},t={};return e.types=function(e){if("object"===(void 0===e?"undefined":_typeof(e)))SDK.core.util.assignProperties(t,e,function(e){return SDK.trim(e).toLowerCase()});else{if("string"==typeof e){var n=e.toLowerCase();return t[n]?t[n]:e}if(SDK.isEmpty(e))return t;SDK.log("typeCenter.types(arg):arg not support-"+e,"WARN")}},e}(),GS={version:"1.0",autoload:!1,init:function(e){SDK.log("[SDK]init","INFO",e)},createChannel:function(e){var t=SDK.suite(e).createWidget("CHANNEL","CHANNEL");return SDK.api.widget.proxy(t.id)},removeChannel:function(e,t){SDK.suite(t).removeWidget(e)},clearChannel:function(){SDK.suite().clearWidget()}},tool={};tool.LogCache="",tool.checkObjectIsNull=function(e){return null==e||void 0==e||void 0===e},tool.checkObjectIsNotNull=function(e){return!this.checkObjectIsNull(e)},tool.isFunction=function(e){return"function"==typeof e},tool.checkParamsIsNotNull=function(str,obj){if(this.checkObjectIsNotNull(str)){for(var splitArray=str.split("."),objSplit="",i=0;i<splitArray.length;i++)if(0!=i?(objSplit+=".",objSplit+=splitArray[i]):objSplit="obj",eval("typeof("+objSplit+")=='undefined'"))return!1;return!0}return!1},tool.extend=function(){var e,t,n,i=arguments[0]||{},r=1,o=arguments.length;for("boolean"==typeof i&&(i,i=arguments[1]||{},r=2),"object"===(void 0===i?"undefined":_typeof(i))||this.isFunction(i)||(i={}),o===r&&(i=this,--r);r<o;r++)if(null!=(e=arguments[r]))for(t in e)i[t],n=e[t],i!==n&&void 0!==n&&(i[t]=n);return i},tool.trim=function(e){return"string"!=typeof e?e:"function"==typeof e.trim?e.trim():e.replace(/^(\u3000|\s|\t|\u00A0)*|(\u3000|\s|\t|\u00A0)*$/g,"")},tool.isEmptyObject=function(e){for(var t in e)return!1;return!0},tool.isEmpty=function(e){return void 0===e||(null==e||"string"==typeof e&&""==tool.trim(e))},tool.decodeHex=function(e){if(e.length%2)return"";for(var t="",n=0;n<e.length;n+=2)t+="%"+e.charAt(n)+e.charAt(n+1);return decodeURIComponent(t)},tool.createUUID=function(){var e=new Date(1582,10,15,0,0,0,0),t=new Date,n=t.getTime()-e.getTime(),i="-";return tool.getIntegerBits(n,0,31)+i+tool.getIntegerBits(n,32,47)+i+(tool.getIntegerBits(n,48,59)+"1")+i+tool.getIntegerBits(tool.rand(4095),0,7)+tool.getIntegerBits(tool.rand(4095),0,7)+i+(tool.getIntegerBits(tool.rand(8191),0,7)+tool.getIntegerBits(tool.rand(8191),8,15)+tool.getIntegerBits(tool.rand(8191),0,7)+tool.getIntegerBits(tool.rand(8191),8,15)+tool.getIntegerBits(tool.rand(8191),0,15))},tool.getIntegerBits=function(e,t,n){var i=tool.returnBase(e,16),r=new Array,o="",a=0;for(a=0;a<i.length;a++)r.push(i.substring(a,a+1));for(a=Math.floor(t/4);a<=Math.floor(n/4);a++)r[a]&&""!=r[a]?o+=r[a]:o+="0";return o},tool.returnBase=function(e,t){var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(e<t)var i=n[e];else{var r=""+Math.floor(e/t),o=e-r*t;if(r>=t)var i=this.returnBase(r,t)+n[o];else var i=n[r]+n[o]}return i},tool.rand=function(e){return Math.floor(Math.random()*e)},tool.isArray=function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&"[object Array]"===Object.prototype.toString.call(e)},tool.createXml=function(e,t){t=tool.isEmpty(t)?"":'encoding="'+t+'"';var n='<?xml version="1.0" '+t+"?>";return tool.isEmpty(e)||(n+=tool.createNode(e)),n},tool.createNode=function(e,t){if(tool.isEmpty(t)&&(t=!0),!tool.isEmpty(e)&&!tool.isEmpty(e.nodeName)){var n="<"+e.nodeName;if(!this.isEmpty(e.attrArray))for(var i=0;i<e.attrArray.length;i++){var r=e.attrArray[i];n+=" "+r.name+'="'+r.value+'"'}var n=n+">";tool.isEmpty(e.value)||(t?n=n+"<![CDATA["+e.value+"]]>":n+=e.value);var n=n+"</"+e.nodeName+">";return n}},tool.createNodeNone=function(e){if(!tool.isEmpty(e)&&!tool.isEmpty(e.nodeName)){var t="<"+e.nodeName;if(!tool.isEmpty(e.attrArray))for(var n=0;n<e.attrArray.length;n++){var i=e.attrArray[n];t+=" "+i.name+'="'+i.value+'"'}var t=t+"/>";return t}},tool.createNodeText=function(e,t){if(tool.isEmpty(t)&&(t=!0),!tool.isEmpty(e)&&!tool.isEmpty(e.nodeName)){var n="<"+e.nodeName;if(!tool.isEmpty(e.attrArray))for(var i=0;i<e.attrArray.length;i++){var r=e.attrArray[i];n+=" "+r.name+'="'+r.value+'"'}var n=n+">";if(tool.isEmpty(e.value)||(t?n=n+"<![CDATA["+e.value+"]]>":n+=e.value),!tool.isEmpty(e.textArray)&&e.textArray.length>0)for(var i=0;i<e.textArray.length;i++){var o=e.textArray[i];tool.isEmpty(o.nodeName)||(n=n+"<"+o.nodeName+"><![CDATA[",tool.isEmpty(o.value)||(n+=o.value),n=n+"]]></"+o.nodeName+">")}var n=n+"</"+e.nodeName+">";return n}},tool.addNode=function(e,t,n,i){var r=0;if(tool.isEmpty(n)){var o=e;if(-1==(r=o.lastIndexOf("</")))return}else{tool.isEmpty(i)&&(i=1);for(var o=e,a=0,s=0;s<i;s++){if(-1==(a=o.indexOf(n,a)))return;var l=o.lastIndexOf("<",a),u=o.lastIndexOf("</",a);l<=u&&s--,a+=n.length}if(0==a)return;o=o.substring(a+n.length),r+=a+n.length,a=0;for(var c=0,d=!0;d;){if(-1==(a=o.indexOf(n)))return;var l=o.lastIndexOf("<",a),u=o.lastIndexOf("</",a);l<=u?c--:c++,c<0&&(r+=u,d=!1)}}return e.substring(0,r)+t+e.substring(r)},tool.formatXml=function(e){return(new DOMParser).parseFromString(e,"application/xml")},tool.parseXml=function(e){var t;return t=(new DOMParser).parseFromString(e),e=t},tool.getXmlNodeAttr=function(e,t){return e&&e.attributes?null!=e.attributes[t]?e.attributes[t].value:null!=e.attributes.getNamedItem(t)?e.attributes.getNamedItem(t).value:"":""},tool.getNodeValue=function(e){return tool.trim(e.textContent)},tool.logMangement=function(){function e(e,t){try{var n=e;e={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()},/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in e)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[i]:("00"+e[i]).substr((""+e[i]).length)));return t}catch(e){return null}}var t=this,n=wx.getFileSystemManager(),i=wx.env.USER_DATA_PATH;this.options={extensionName:"log",codingType:"utf8",_dateFileName:e(new Date,"yyyy-MM-dd"),logDirectory:i+"/log",uploadFileUrl:"https://traceupload.gensee.com/traupload",clientApi:null},this.writeFile=function(e){var t=i+"/log/"+this.options._dateFileName+"."+this.options.extensionName,r=this;n.access({path:r.options.logDirectory,success:function(){},fail:function(){n.mkdirSync(r.options.logDirectory)}}),n.access({path:t,success:function(){if(n.appendFile)n.appendFile({filePath:t,data:"\r\n"+e,encoding:r.options.codingType});else{var o=r.readFile(r.options._dateFileName+"."+r.options.extensionName);n.writeFile({filePath:t,data:o+"\r\n"+e,encoding:r.options.codingType,success:function(){n.readdir({dirPath:r.options.logDirectory,success:function(e){if(e.files.length>=4)for(var t=e.files.length-3,r=0;r<t;r++)n.unlinkSync(i+"/log/"+e.files[r])}})}})}},fail:function(){wx.getFileInfo({filePath:t,success:function(o){o.size<=5e6?n.writeFile({filePath:t,data:e,encoding:r.options.codingType,success:function(e){n.readdir({dirPath:r.options.logDirectory,success:function(e){if(e.files.length>=4)for(var t=e.files.length-3,r=0;r<t;r++)n.unlinkSync(i+"/log/"+e.files[r])}})}}):n.readdir({dirPath:r.options.logDirectory,success:function(e){if(e.files.length>0)for(var t=e.files.length,r=0;r<t;r++)n.unlinkSync(i+"/log/"+e.files[r])}})},fail:function(){n.readdir({dirPath:r.options.logDirectory,success:function(o){if(o.files.length>0)for(var a=o.files.length,s=0;s<a;s++)n.unlinkSync(i+"/log/"+o.files[s]);else n.writeFile({filePath:t,data:e,encoding:r.options.codingType,success:function(e){if(o.files.length>=4)for(var t=o.files.length-3,r=0;r<t;r++)n.unlinkSync(i+"/log/"+o.files[r])}})}})}})}})},this.readFile=function(e){return n.readFileSync(i+"/log/"+e,this.options.codingType)},this.uploadLogFile=function(n,r,o,a,s,l,u,c){var d={id:n,site:r,ctx:o,siteid:a,userid:s,username:l};u?(u.clientApi?this.options.clientApi=u.clientApi+"?sc="+("webcast"===d.ctx?0:1):this.options.clientApi="http://"+d.site+"/clientapi/apichannel?sc="+("webcast"===d.ctx?0:1),u.diagnoseUploadUrl&&(this.options.uploadFileUrl=u.diagnoseUploadUrl)):this.options.clientApi="http://"+d.site+"/clientapi/apichannel?sc="+("webcast"===d.ctx?0:1);var p=wx.getFileSystemManager();try{p.accessSync(this.options.logDirectory);var f=p.readdirSync(this.options.logDirectory);if(f.length>0&&d){for(var h=null,m=0;m<f.length;m++)h?h+=t.readFile(f[m]):h=t.readFile(f[m]);var g="MiniProgram-"+d.siteid+"-"+d.id+"-"+d.userid+"-"+d.username+"-"+e(new Date,"yyyyMMddhhmmss")+"."+this.options.extensionName;p.writeFileSync(i+"/log/"+g,h,this.options.codingType),wx.uploadFile({url:this.options.uploadFileUrl,filePath:i+"/log/"+g,name:"file1",success:function(e){var n=e.data;t.postLog(n,d,c);try{p.unlinkSync(i+"/log/"+g)}catch(e){console.log(e)}}})}}catch(e){console.log(e)}},this.postLog=function(e,t,n){wx.request({url:this.options.clientApi,header:{"content-type":"text/xml"},method:"POST",data:"<?xml version='1.0' encoding='UTF-8' standalone='yes' ?>\n      <clientDiagnosis confid=\""+t.id+'" siteid="'+t.siteid+'" userid="'+t.userid+'">\n        <file type="log">\n          <![CDATA['+e+"]]>\n        </file>\n        <username>\n          <![CDATA[support]]>\n        </username>\n        <desc>\n          <![CDATA[Mini Program VodSDK Diagonse ]]>\n        </desc>\n      </clientDiagnosis>",success:function(e){"function"==typeof n&&n(e.data)}})}},tool.logger=function(e){var t=this,n=!1;this.sessionId=null,this.name=e,this.logs=[];var i={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4};this.level="INFO",this.out=function(e){t.logs.push(e)},this.log=function(e,n,r){n=n||"info";var o=i[n.toUpperCase()],a=i[t.level.toUpperCase()];if(!("number"==typeof o&&"number"==typeof a&&o<a)){if("string"!=typeof e)return void this.log("log(msg, type), type of msg must be 'string'","ERROR",e);t.out({time:new Date,msg:e,type:n,data:r});var s=new Date,l="["+s.toTimeString()+"]"+JSON.stringify({time:new Date,msg:e,type:n,data:r}),u=new tool.logMangement;tool.LogCache+="\r\n"+l,tool.LogCache.length>=1e3&&(u.writeFile(tool.LogCache),tool.LogCache=" "),t.sendSocketMessage(l)}},this.moveLogs=function(e){return t.logs.splice(0,e||t.logs.length)},this.connectSocket=function(e){e?wx.connectSocket({url:"ws://"+e+":8088"}):wx.connectSocket({url:"ws://test.gensee.net:8088"}),t.onSocketOpen()},this.onSocketMessage=function(e){wx.onSocketMessage(function(t){e(t)})},this.onSocketClose=function(e){wx.onSocketClose(function(e){n=!1})},this.onSocketOpen=function(e){wx.onSocketOpen(function(e){n=!0,t.sessionId=t._RndNum(5),t.sendSocketMessage("startSend:"+t.sessionId)})},this.sendSocketMessage=function(e){n&&wx.sendSocketMessage({data:e})},this._RndNum=function(e){for(var t="",n=0;n<e;n++)t+=Math.floor(10*Math.random());return t}},tool.isBlank=function(e){return!(!this.isEmpty(e)&&""!=this.trim(e))},tool.ajax=function(e){wx.request({url:e.url,header:e.header,method:e.type,responseType:e.responseType,dataType:e.dataType,data:e.data,success:e.success,fail:e.error})},tool.isNumber=function(e){return!this.isEmpty(e)&&/^([0-9]|[1-9][0-9]*|[0-9]\.[0-9]+|[1-9][0-9]*\.[0-9]+)$/.test(e)};var hTasks=[],Gensee_ExecutedImmediately_Time=null,annoCount=0,pptCount=0,pptModuleCount=0,task=function(e){hTasks=e.hTasks,Gensee_ExecutedImmediately_Time=null,annoCount=e.annoCount,pptCount=e.pptCount,pptModuleCount=e.pptModuleCount;var t=this;this.executedImmediately=void 0!=e.executedImmediately&&e.executedImmediately,Gensee_ExecutedImmediately_Time=this.executedImmediately?5e3:2e4,this.taskArray=new Array,this.taskFunction=new Array,this.defaultOpt={interval:200,status:!1},this.anyOpt={interval:200,status:!1},this.timeOutObj=null,this.anyOutObj=null,this.dealTask=!1,this.i=0,this.timeOut=function(){t.dealTask=!0;var e=t.taskArray,n=t.taskFunction;if(e.length>0){var i=1e3*app.globalData.currentTime;if(i>=0)for(var r=0;r<e.length;r++){var o=e[r];if(null==o.startTime||void 0==o.startTime||void 0===o.startTime||""==o.startTime){for(var a=o.type,s=0;s<n.length;s++){var l=n[s];if(l.type==a){l.startFun.call(this,o.data);break}}e.splice(r,1),r--}else if(o.startTime<=i)if(null==o.endTime||void 0==o.endTime||void 0===o.endTime||""==o.endTime){for(var a=o.type,s=0;s<n.length;s++){var l=n[s];if(l.type==a){l.startFun.call(this,o.data);break}}e.splice(r,1),r--}else if(i<o.endTime){var a=o.type;if(null==o.startDeal||void 0==o.startDeal||void 0===o.startDeal)for(var s=0;s<n.length;s++){var l=n[s];if(l.type==a){o.startDeal=!0,l.startFun.call(this,o.data);break}}}else{for(var a=o.type,s=0;s<n.length;s++){var l=n[s];if(l.type==a){l.endFun.call(this,o.data);break}}e.splice(r,1),r--}}}t.dealTask=!1},this.anyTimeOut=function(){var e=t.taskArray,n=t.taskFunction;if(e.length>0)for(var i=0;i<e.length;i++){var r=e[i];if("ems"==r.type&&("onPriChat"==r.data.dealFunction||"onChatRemove"==r.data.dealFunction||"onPublicChat"==r.data.dealFunction||"onThirdPartChat"==r.data.dealFunction||"onSetting"==r.data.dealFunction&&"chat"==r.data.content.option)){for(var o=r.type,a=0;a<n.length;a++){var s=n[a];if(s.type==o){s.startFun.call(this,r.data);break}}e.splice(i,1),i--}}}};task.prototype.switchMedia=function(e){this.media=media},task.prototype.setInterval=function(e){var t=this;return!this.dealTask&&(this.defaultOpt.interval=e,this.defaultOpt.status&&(clearInterval(this.timeOutObj),this.timeOutObj=setInterval(function(){t.timeOut()},this.defaultOpt.interval)),!0)},task.prototype.start=function(){var e=this;null!=this.anyOutObj&&clearInterval(this.anyOutObj),this.defaultOpt.status||(this.timeOutObj=setInterval(function(){e.timeOut()},this.defaultOpt.interval),this.defaultOpt.status=!0)},task.prototype.stop=function(){return!this.dealTask&&(clearInterval(this.timeOutObj),this.defaultOpt.status=!1,!0)},task.prototype.anyStart=function(){var e=this;this.anyOpt.status||(this.anyOutObj=setInterval(function(){e.anyTimeOut()},this.anyOpt.interval),this.anyOpt.status=!0)},task.prototype.addTaskFunction=function(e,t,n){var i=this.taskFunction;if(tool.checkObjectIsNull(e))return!1;if(!tool.isFunction(t))return!1;var r={type:e,startFun:t};return tool.isFunction(n)?r.endFun=n:r.endFun=function(){},i.push(r),!0},task.prototype.addTask=function(e,t,n,i){this.taskArray;if(tool.checkObjectIsNull(e))return!1;var r={};if(t.taskId){if(compareHisTask(e+t.taskId))return;loadHisTask(e+t.taskId)}for(var o=this.taskFunction,r={type:e,data:t,startTime:null,endTime:null},a=r.type,s=0;s<o.length;s++){var l=o[s];if(l.type==a)switch(a){case"anno_sdk":0==annoCount?(annoCount++,function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},0)}(l,r)):function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},Gensee_ExecutedImmediately_Time)}(l,r);break;case"ppt_sdk":0==pptCount?(pptCount++,function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},0)}(l,r)):function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},Gensee_ExecutedImmediately_Time)}(l,r);break;case"ppt_module":0==pptModuleCount?(pptModuleCount++,function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},0)}(l,r)):function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},Gensee_ExecutedImmediately_Time)}(l,r);break;default:!function(e,t){setTimeout(function(){e.startFun.call(this,t.data)},0)}(l,r)}}},task.prototype.clearTask=function(){var e=this.taskArray;e.splice(0,e.length)},task.prototype.executeAllTask=function(){var e=this.taskArray;console.log("[executeAllTask]:"+e.length);for(var t=0;t<e.length;t++){var n=e[t];n.startTime=null,n.endTime=null}};var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_SPACE=2,S_EQ=3,S_ATTR_NOQUOT_VALUE=4,S_ATTR_END=5,S_TAG_SPACE=6,S_TAG_CLOSE=7;XMLReader.prototype={parse:function(e,t,n){var i=this.domBuilder;i.startDocument(),_copy(t,t={}),_parse(e,t,n,i,this.errorHandler),i.endDocument()}},ElementAttributes.prototype={setTagName:function(e){if(!tagNamePattern.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!tagNamePattern.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},exports.XMLReader=XMLReader;var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},INDEX_SIZE_ERR=ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),DOMSTRING_SIZE_ERR=ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3),WRONG_DOCUMENT_ERR=ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),INVALID_CHARACTER_ERR=ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),NO_DATA_ALLOWED_ERR=ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),NO_MODIFICATION_ALLOWED_ERR=ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8),NOT_SUPPORTED_ERR=ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10),INVALID_STATE_ERR=ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),SYNTAX_ERR=ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),INVALID_MODIFICATION_ERR=ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),NAMESPACE_ERR=ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),INVALID_ACCESS_ERR=ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],i=0;i<this.length;i++)serializeToString(this[i],n,e,t);return n.join("")}},LiveNodeList.prototype.item=function(e){return _updateLiveList(this),this[e]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var n=this.getNamedItem(e.nodeName);return _addNamedNode(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return t=this.getNamedItemNS(e.namespaceURI,e.localName),_addNamedNode(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return _removeNamedNode(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return _removeNamedNode(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var i=this[n];if(i.localName==t&&i.namespaceURI==e)return i}return null}},DOMImplementation.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var i=new Document;if(i.implementation=this,i.childNodes=new NodeList,i.doctype=n,n&&i.appendChild(n),t){var r=i.createElementNS(e,t);i.appendChild(r)}return i},createDocumentType:function(e,t,n){var i=new DocumentType;return i.name=e,i.nodeName=e,i.publicId=t,i.systemId=n,i}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return _insertBefore(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return _removeChild(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return _cloneNode(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==TEXT_NODE&&e.nodeType==TEXT_NODE?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var i in n)if(n[i]==e)return i;t=t.nodeType==ATTRIBUTE_NODE?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==ATTRIBUTE_NODE?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==DOCUMENT_FRAGMENT_NODE){for(var n=e.firstChild;n;){var i=n.nextSibling;this.insertBefore(n,t),n=i}return e}return null==this.documentElement&&e.nodeType==ELEMENT_NODE&&(this.documentElement=e),_insertBefore(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),_removeChild(this,e)},importNode:function(e,t){return _importNode(this,e,t)},getElementById:function(e){var t=null;return _visitNode(this.documentElement,function(n){if(n.nodeType==ELEMENT_NODE&&n.getAttribute("id")==e)return t=n,!0}),t},createElement:function(e){var t=new Element;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new NodeList,(t.attributes=new NamedNodeMap)._ownerElement=t,t},createDocumentFragment:function(){var e=new DocumentFragment;return e.ownerDocument=this,e.childNodes=new NodeList,e},createTextNode:function(e){var t=new Text;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Comment;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new CDATASection;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ProcessingInstruction;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new Attr;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new EntityReference;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new Element,i=t.split(":"),r=n.attributes=new NamedNodeMap;return n.childNodes=new NodeList,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,r._ownerElement=n,n},createAttributeNS:function(e,t){var n=new Attr,i=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,n}},_extends(Document,Node),Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(e,null):_appendSingleChild(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+n,this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new LiveNodeList(this,function(t){var n=[];return _visitNode(t,function(i){i===t||i.nodeType!=ELEMENT_NODE||"*"!==e&&i.tagName!=e||n.push(i)}),n})},getElementsByTagNameNS:function(e,t){return new LiveNodeList(this,function(n){var i=[];return _visitNode(n,function(r){r===n||r.nodeType!==ELEMENT_NODE||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||i.push(r)}),i})}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(e,t,n){return nodeSerializeToString.call(e,t,n)},Node.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){var getTextContent=function e(t){switch(t.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(e){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),__set__=function(e,t,n){e["$$"+t]=n}}}catch(e){}exports.DOMImplementation=DOMImplementation,exports.XMLSerializer=XMLSerializer,DOMParser.prototype.parseFromString=function(e,t){var n=this.options,i=new XMLReader,r=n.domBuilder||new DOMHandler,o=n.errorHandler,a=n.locator,s=n.xmlns||{},l=/\/x?html?$/.test(t),u=l?htmlEntity.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return a&&r.setDocumentLocator(a),i.errorHandler=buildErrorHandler(o,r,a),i.domBuilder=n.domBuilder||r,l&&(s[""]="http://www.w3.org/1999/xhtml"),s.xml=s.xml||"http://www.w3.org/XML/1998/namespace",e?i.parse(e,s,u):i.errorHandler.error("invalid doc source"),r.doc},DOMHandler.prototype={startDocument:function(){this.doc=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,i){var r=this.doc,o=r.createElementNS(e,n||t),a=i.length;appendElement(this,o),this.currentElement=o,this.locator&&position(this.locator,o);for(var s=0;s<a;s++){e=i.getURI(s);var l=i.getValue(s),u=(n=i.getQName(s),r.createAttributeNS(e,n));this.locator&&position(i.getLocator(s),u),u.value=u.nodeValue=l,o.setAttributeNode(u)}},endElement:function(e,t,n){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&position(this.locator,n),appendElement(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=_toString.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(e);else i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&position(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=_toString.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&position(this.locator,i),appendElement(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(e,t,n);this.locator&&position(this.locator,r),appendElement(this,r)}},warning:function(e){console.warn("[xmldom warning]\t"+e,_locator(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,_locator(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,_locator(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){DOMHandler.prototype[e]=function(){return null}}),module.exports={GS:GS,tool:tool,task:task,DOMParser:DOMParser};